<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>대시보드</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
<div class="layout">
    <aside class="sidebar">
        <div class="brand">재고 관리</div>
        <nav>
            <a href="/" data-page="dashboard">대시보드</a>
            <a href="/ui/products" data-page="products">제품 관리</a>
            <a href="/ui/lots" data-page="lots">로트 관리</a>
            <a href="/ui/inbound" data-page="inbound">입고 등록</a>
            <a href="/ui/outbound" data-page="outbound">출고 등록</a>
            <a href="/ui/transactions" data-page="transactions">입출고 이력</a>
            <a href="/docs" target="_blank">API 문서</a>
        </nav>
    </aside>
    <main class="content">
        <h1 class="page-title">대시보드</h1>
        <div class="grid grid-3">
            <div class="card">
                <div class="label">제품 수</div>
                <div id="product-count" class="badge">-</div>
            </div>
            <div class="card">
                <div class="label">로트 수</div>
                <div id="lot-count" class="badge">-</div>
            </div>
            <div class="card">
                <div class="label">총 수량</div>
                <div id="total-qty" class="badge">-</div>
            </div>
        </div>
        <div id="dashboard-message"></div>
    </main>
</div>
<script>
const currentPath = window.location.pathname;
document.querySelectorAll('.sidebar a').forEach(link => {
    if (link.getAttribute('href') === currentPath) link.classList.add('active');
});

async function loadSummary() {
    const messageBox = document.getElementById('dashboard-message');
    messageBox.innerHTML = '';
    try {
        const res = await fetch('/dashboard/summary');
        if (!res.ok) throw new Error('요청 처리 중 오류가 발생했습니다.');
        const data = await res.json();
        document.getElementById('product-count').innerText = data.product_count;
        document.getElementById('lot-count').innerText = data.lot_count;
        document.getElementById('total-qty').innerText = data.total_qty;
    } catch (err) {
        messageBox.innerHTML = `<div class="message error">${err.message}</div>`;
    }
}

loadSummary();
</script>
</body>
</html>
